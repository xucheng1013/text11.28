!function(e){"use strict";var t,i=e.Base64,r="2.1.9";if("undefined"!=typeof module&&module.exports)try{t=require("buffer").Buffer}catch(n){}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(e){for(var t={},i=0,r=e.length;r>i;i++)t[e.charAt(i)]=i;return t}(o),a=String.fromCharCode,c=function(e){if(e.length<2){var t=e.charCodeAt(0);return 128>t?e:2048>t?a(192|t>>>6)+a(128|63&t):a(224|t>>>12&15)+a(128|t>>>6&63)+a(128|63&t)}var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return a(240|t>>>18&7)+a(128|t>>>12&63)+a(128|t>>>6&63)+a(128|63&t)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,p=function(e){return e.replace(l,c)},u=function(e){var t=[0,2,1][e.length%3],i=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),r=[o.charAt(i>>>18),o.charAt(i>>>12&63),t>=2?"=":o.charAt(i>>>6&63),t>=1?"=":o.charAt(63&i)];return r.join("")},h=e.btoa?function(t){return e.btoa(t)}:function(e){return e.replace(/[\s\S]{1,3}/g,u)},d=t?function(e){return(e.constructor===t.constructor?e:new t(e)).toString("base64")}:function(e){return h(p(e))},f=function(e,t){return t?d(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):d(String(e))},m=function(e){return f(e,!0)},g=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),b=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),i=t-65536;return a((i>>>10)+55296)+a((1023&i)+56320);case 3:return a((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return a((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},v=function(e){return e.replace(g,b)},w=function(e){var t=e.length,i=t%4,r=(t>0?s[e.charAt(0)]<<18:0)|(t>1?s[e.charAt(1)]<<12:0)|(t>2?s[e.charAt(2)]<<6:0)|(t>3?s[e.charAt(3)]:0),n=[a(r>>>16),a(r>>>8&255),a(255&r)];return n.length-=[0,0,2,1][i],n.join("")},y=e.atob?function(t){return e.atob(t)}:function(e){return e.replace(/[\s\S]{1,4}/g,w)},x=t?function(e){return(e.constructor===t.constructor?e:new t(e,"base64")).toString()}:function(e){return v(y(e))},A=function(e){return x(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},q=function(){var t=e.Base64;return e.Base64=i,t};if(e.Base64={VERSION:r,atob:y,btoa:h,fromBase64:A,toBase64:f,utob:p,encode:f,encodeURI:m,btou:v,decode:A,noConflict:q},"function"==typeof Object.defineProperty){var C=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};e.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",C(function(){return A(this)})),Object.defineProperty(String.prototype,"toBase64",C(function(e){return f(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",C(function(){return f(this,!0)}))}}e.Meteor&&(Base64=e.Base64)}(this),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.Msosh=t()}(this,function(){function e(){var e=arguments;this.opts={},"string"===r(e[0])?(this.elems=f.querySelectorAll(e[0]),this.length=this.elems.length,this.opts=e[1],this.init(this.opts)):"object"===r(e[0])&&(this.opts=e[0])}function t(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var r in i)h.call(i,r)&&(e[r]=i[r])}return e}function r(e){return null===e?"null":void 0===typeof e?"undefined":d.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function n(e,t){var i=[];for(var r in t)i.push(r+"="+t[r]);return e+(-1!==e.indexOf("?")?"&":"?")+i.join("&")}function o(e){for(var t=location.search.substring(1),i=t.split("&"),r=i.length,n=0;r>n;n++){var o=i[n].split("=");if(decodeURIComponent(o[0])==e)return decodeURIComponent(o[1])}}function s(e,t,i,r){e.addEventListener(i,function(e){for(var i=e.target,n=e.currentTarget;i&&i!==n;){if(a(i,t))return void r.call(i,e);i=i.parentNode}},!1)}function a(e,t){var i=Element.prototype,r=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||function(e){return-1!==[].indexOf.call(f.querySelectorAll(e),this)};return r.call(e,t)}function c(e,t){var i=f.createElement("script");i.src=e,i.onload=onreadystatechange=function(){this.readyState&&"load"!==this.readyState&&"complete"!==this.readyState||(t&&t(),i.onload=onreadystatechange,i.parentNode.removeChild(i))},m.appendChild(i)}function l(e){return e=e.toLowerCase(),-1!==v.indexOf(e)}function p(e){var t=e.split(".");return parseFloat(t[0]+"."+t[1])}function u(e){if(_>8)window.location.href=e;else{var t=f.createElement("iframe");t.style.display="none",t.src=e,m.appendChild(t),setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},5e3)}}var h=Object.prototype.hasOwnProperty,d=Object.prototype.toString,f=document,m=f.body,g=f.getElementsByName("description")[0],b=f.getElementsByTagName("img")[0],v=navigator.userAgent.toLowerCase(),w=l("iPhone")||l("iPad")||l("iPod"),y=l("Android"),x=l("UCBrowser"),A=l("MQQBrowser"),q=l("MicroMessenger"),C=A?p(v.split("mqqbrowser/")[1]):0,S=x?p(v.split("ucbrowser/")[1]):0,_=w?parseInt(v.match(/\s*os\s*\d/gi)[0].split(" ")[2],10):0,B=!1;(w&&S>=10.2||y&&S>=9.7||C>=5.4)&&(B=!0),q&&m.insertAdjacentHTML("beforeend",'<div class="msosh-wxsharetip"></div>');var E='<a class="msosh-item {{site}}" data-site="{{site}}" href="javascript:;"><em class="msosh-item-icon">{{icon}}</em><span class="msosh-item-text">{{name}}</span></a>',T={weixin:{name:"微信好友",icon:"&#xeA07;"},weixintimeline:{name:"朋友圈",icon:"&#xeA10;"},qq:{name:"QQ好友",icon:"&#xeA09;",scheme:"mqqapi://share/to_fri?src_type=web&version=1&file_type=news"},qzone:{name:"QQ空间",icon:"&#xeA02;",api:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={{url}}&title={{title}}&pics={{pic}}&desc={{digest}}",scheme:w?"mqqapi://share/to_fri?file_type=news&src_type=web&version=1&generalpastboard=1&shareType=1&cflag=1&objectlocation=pasteboard&callback_type=scheme&callback_name=QQ41AF4B2A":"mqqapi://share/to_qzone?src_type=app&version=1&file_type=news&req_type=1"},yixin:{name:"易信",icon:"&#xeA08;",api:"http://open.yixin.im/share?url={{url}}&title={{title}}&pic={{pic}}&desc={{digest}}"},weibo:{name:"微博",icon:"&#xeA06;",api:"http://service.weibo.com/share/share.php?url={{url}}&title={{title}}&pic={{pic}}"},tqq:{name:"腾讯微博",icon:"&#xeA05;",api:"http://share.v.t.qq.com/index.php?c=share&a=index&url={{url}}&title={{title}}&pic={{pic}}"},renren:{name:"人人网",icon:"&#xeA03;",api:"http://widget.renren.com/dialog/share?resourceUrl={{url}}&title={{title}}&pic={{pic}}&description={{digest}}"},douban:{name:"豆瓣",icon:"&#xeA01;",api:"http://douban.com/recommend/?url={{url}}&title={{title}}&image={{pic}}"},tieba:{name:"百度贴吧",icon:"&#xeA04;",api:"http://tieba.baidu.com/f/commit/share/openShareApi?url={{url}}&title={{title}}&desc={{digest}}"}},j={weibo:["kSinaWeibo","SinaWeibo",11],weixin:["kWeixin","WechatFriends",1],weixintimeline:["kWeixinFriend","WechatTimeline",8],qq:["kQQ","QQ",4],qzone:["kQZone","Qzone",3]},O={title:f.title,url:location.href,digest:g&&g.content||"",pic:b&&b.src||"",from:location.host,sites:["weixin","weixintimeline","yixin","weibo","qq","qzone"]};return e.prototype={constructor:this,init:function(e){var r=o("__msoshbridge");if(r&&"function"==typeof history.replaceState){var n=location.href.replace(new RegExp("[&?]__msoshbridge="+r,"gi"),"");history.replaceState(null,f.title,n),this.shareTo(r,t(O,e))}if(this.length)for(i=0;i<this.length;i++){var s=this.elems[i],a=t(s.dataset);a.sites&&(a.sites=a.sites.split(","));var c=t(O,e,a),l=this.getSitesHtml(c.sites);s.insertAdjacentHTML("beforeend",l),s.classList.add("msosh"),this._handlerClick(s,c)}},getSitesHtml:function(e,t){for(var i=0,n="",o=e.length,t="number"===r(t)&&0!==t?t:0;o>i;i++)t&&i%t===0&&(n+='<div class="msosh-group group'+(i/t+1)+'">'),n+=this.parseTemplate(e[i]),!t||i%t!==t-1&&i!==o-1||(n+="</div>");return n},parseTemplate:function(e){return T[e]?E.replace(/\{\{site\}\}/g,e).replace(/\{\{icon\}\}/g,T[e].icon).replace(/\{\{name\}\}/g,T[e].name):(console.warn("site ["+e+"] not exist."),"")},shareTo:function(t,i){var r,o,s=this,a=T[t].api;if(B){if(x&&(j[t]&&(r=w?j[t][0]:j[t][1]),void 0!==r))return o=[i.title,i.digest,i.url,r,"","@"+i.from,""],window.ucweb&&ucweb.startRequest&&ucweb.startRequest("shell.page_share",o),void(window.ucbrowser&&ucbrowser.web_share&&ucbrowser.web_share.apply(null,o));if(A&&(j[t]&&(r=j[t][2]),void 0!==r))return void(window.browser?(o={url:i.url,title:i.title,description:i.digest,img_url:i.pic,img_title:i.title,to_app:r,cus_txt:""},browser.app&&browser.app.share(o)):c("//jsapi.qq.com/get?api=app.share",function(){s.shareTo(t,i)}))}if("qzone"===t||"qq"==t){var l=n(T[t].scheme,{share_id:"1101685683",url:Base64.encode(i.url),title:Base64.encode(i.title),description:Base64.encode(i.digest),previewimageUrl:Base64.encode(i.pic),image_url:Base64.encode(i.pic)});return void u(l)}if(-1!==t.indexOf("weixin")){var p=n(location.href,{__msoshbridge:t});u("mttbrowser://url="+p)}if(q&&-1!==t.indexOf("weixin"))return void e.wxShareTip();if(a){for(k in i)a=a.replace(new RegExp("{{"+k+"}}","g"),encodeURIComponent(i[k]));window.open(a,"_blank")}},popIn:function(e){if(!this.popElem){var i=t(O,this.opts,e),r='<div class="msosh-pop"><div class="msosh-pop-sites">'+this.getSitesHtml(i.sites,3)+"</div></div>";m.insertAdjacentHTML("beforeend",r),this.popElem=f.querySelector(".msosh-pop"),this.popClass=this.popElem.classList,this._handlerClick(this.popElem,i),this.popElem.onclick=function(){this.popOut()}.bind(this)}this.popClass.remove("msosh-pop-hide"),this.popElem.style.display="block",setTimeout(function(){this.popClass.add("msosh-pop-show")}.bind(this),0)},popOut:function(){this.popElem&&(this.popClass.remove("msosh-pop-show"),this.popClass.add("msosh-pop-hide"),setTimeout(function(){this.popElem.style.display="none"}.bind(this),800))},_handlerClick:function(e,t){var i=this;s(e,".msosh-item","click",function(){i.shareTo(this.dataset.site,t)})}},e.wxShareTip=function(e){if("number"!==r(e)&&(e=2e3),q){var t=f.querySelector(".msosh-wxsharetip");t.classList.add("wxsharetip-show"),setTimeout(function(){t.classList.remove("wxsharetip-show")},e)}},m.addEventListener("touchstart",function(){},!1),e});